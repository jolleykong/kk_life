[TOC]

# 主键索引

- 主键由表中的一个或多个列组成，用于唯一地标识表中的某一条记录
- 在表引用中，主键在一个表中引用来自于另一个表中的特定记录（外键）
- 保证数据的完整性
- 加快数据的操作速度，给予主键的update时查找起来更高效
- 主键键值不能重复，也不能包含null

- InnoDB中，主键索引一定是聚集索引，但反之不一定

- 可以将旧系统中，有业务用途的主键转为唯一索引

 

## 主键选择建议

- 对业务透明，无意义，免受业务变化的影响
- 很少修改和删除
- 最好是自增的
- 不要具有动态属性，例如随机值

 

## InnoDB聚集索引的次序原则

1. 显式声明的主键
2. 第一个NOT     NULLABLE的唯一索引
3. DB_ROW_ID（实例级别，6B。全实例里的表共同使用这个ID队列。）

- 主键索引一定是聚集索引
- 聚集索引不一定是主键索引
- InnoDB表一定有聚集索引

 

 

## InnoDB主键特点

- 索引（辅助索引）定义时，*不管有无显式包含主键，实际都会存储主键键值。*

- 在5.6.9版本以后，优化器支持Index Extensions特性，能自动识别辅助索引末尾的主键键值。在此之前则需要显式的在语句中加上主键列才可以被识别（用主键索引），5.6.9版本以后，可以直接使用辅助索引完成下列查询：

  ```
  create table a(
  pk int unsigned,
  c1 int unsigned,
  c3 int unsigned not null,
  c4 int unsigned not null,
  primary key(pk),
  key(c1)
  );
  
  实际index c1物理存储为 (c1,pk)
  
  select ... where c1 =? and pk =?
  select ... where pk =? and c1 =?
  最终两个SQL是等价的，都会走这个索引（如果不走主键索引的话）
  ```

  

传送门：[[老叶茶馆\] - 2015-08-10 [MySQL FAQ]系列 — 为什么InnoDB表要建议用自增列做主键.html]( )

 



 

# 辅助索引

- 主键索引叫primary key，一个表里最多只有一个主键
- 辅助索引叫secondary key，也称为二级索引，一个表里可以有多个辅助索引
- 非主键索引，都是辅助索引
- 再细分为唯一、非唯一两种辅助索引

 