[TOC]

# 压测

设计可靠的压测方案，利用压测作为业务指标扩容参考

- 目的
  - 采购新设备，评估新设备性能
  - 开发新项目，评估数据库容量
  - 新系统上线前预估、模拟数据库负载情况
  - 更换数据库版本，评估性能变化



## 基准压力测试

### 设计测试模型

##### 要点

- 明确测试的核心目标、诉求
- 排除干扰，专注测试目的
- 确定测试环境
- 确定测试过程中的衡量和变量
- 保证测试结果的可重复性

##### 注意事项

- 不应只在本地加压
- 压测数据量不要过小
- 压测时间不要过短
- 压测模式不要太少
- 压测负载过于大，或过于小
- 注意每轮测试完毕后要净化环境



### 常用压测工具

- tpcc-mysql

- sysbench

- ycsb

- fio

  OLTP场景使用sysbench就够了。不建议使用tpcc-mysql，因为warehouse数据量并不多，整体模型对IOT表为主的MySQL也并不友好

### 测试方法及结果解读

- 老叶倡议：[MySQL压力测试基准值](.\老叶倡议：MySQL压力测试基准值.md)
- [测试结果模板](./分享我的测试结果模板.md)



### 测试报告编写





## 压测的误区

#### 云数据库压测误区

- 相比自建数据库，从云主机到云数据库，中间经历了更多网络链路
- 压测云主机和云数据库不在同一个可用区时，中间可能实际上跨越公网
  - 物理距离太远可能影响性能测试结果
- 云数据库为了保证数据一致性，开始了双1
- 云数据库为了保证主从数据不丢失，开启半同步复制
- 云数据库部分参数选项配置可能过于保守